
0.0005
  0%|                                                                                                                                                                                                                                                                    | 0/6000 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|                                                                                                                                                                                                                                                         | 1/6000 [00:21<36:19:53, 21.80s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  0%|                                                                                                                                                                                                                                                         | 2/6000 [00:43<36:00:58, 21.62s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|                                                                                                                                                                                                                                                         | 3/6000 [01:04<36:03:11, 21.64s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▏                                                                                                                                                                                                                                                        | 4/6000 [01:26<36:03:02, 21.64s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  0%|▏                                                                                                                                                                                                                                                        | 5/6000 [01:48<36:03:37, 21.65s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▏                                                                                                                                                                                                                                                        | 6/6000 [02:09<36:04:27, 21.67s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▎                                                                                                                                                                                                                                                        | 7/6000 [02:31<36:05:45, 21.68s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▎                                                                                                                                                                                                                                                        | 8/6000 [02:53<36:03:03, 21.66s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▎                                                                                                                                                                                                                                                        | 9/6000 [03:15<36:06:06, 21.69s/it]
An arbitrary loader is used instead of Validation loader


  0%|▍                                                                                                                                                                                                                                                       | 10/6000 [03:36<36:01:08, 21.65s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▍                                                                                                                                                                                                                                                       | 11/6000 [03:58<36:01:30, 21.65s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▍                                                                                                                                                                                                                                                       | 12/6000 [04:19<36:02:17, 21.67s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▌                                                                                                                                                                                                                                                       | 13/6000 [04:41<36:03:03, 21.68s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▌                                                                                                                                                                                                                                                       | 14/6000 [05:03<35:58:32, 21.64s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▌                                                                                                                                                                                                                                                       | 15/6000 [05:25<36:02:52, 21.68s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▋                                                                                                                                                                                                                                                       | 16/6000 [05:47<36:34:42, 22.01s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▋                                                                                                                                                                                                                                                       | 17/6000 [06:09<36:21:43, 21.88s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▋                                                                                                                                                                                                                                                       | 18/6000 [06:30<36:13:40, 21.80s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▊                                                                                                                                                                                                                                                       | 19/6000 [06:52<36:07:21, 21.74s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|▊                                                                                                                                                                                                                                                       | 20/6000 [07:14<36:05:20, 21.73s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▊                                                                                                                                                                                                                                                       | 21/6000 [07:35<36:01:00, 21.69s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▉                                                                                                                                                                                                                                                       | 22/6000 [07:57<35:57:09, 21.65s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▉                                                                                                                                                                                                                                                       | 23/6000 [08:18<35:53:31, 21.62s/it]
An arbitrary loader is used instead of Validation loader


  0%|▉                                                                                                                                                                                                                                                       | 24/6000 [08:40<35:52:27, 21.61s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|█                                                                                                                                                                                                                                                       | 25/6000 [09:02<35:51:06, 21.60s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|█                                                                                                                                                                                                                                                       | 26/6000 [09:23<35:51:20, 21.61s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|█                                                                                                                                                                                                                                                       | 27/6000 [09:45<35:41:54, 21.52s/it]
An arbitrary loader is used instead of Validation loader


  0%|█▏                                                                                                                                                                                                                                                      | 28/6000 [10:06<35:41:25, 21.51s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|█▏                                                                                                                                                                                                                                                      | 29/6000 [10:28<35:45:20, 21.56s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|█▏                                                                                                                                                                                                                                                      | 30/6000 [10:49<35:43:50, 21.55s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▎                                                                                                                                                                                                                                                      | 31/6000 [11:11<35:43:41, 21.55s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▎                                                                                                                                                                                                                                                      | 32/6000 [11:32<35:46:50, 21.58s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|█▎                                                                                                                                                                                                                                                      | 33/6000 [11:54<35:44:11, 21.56s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|█▍                                                                                                                                                                                                                                                      | 34/6000 [12:15<35:41:22, 21.54s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▍                                                                                                                                                                                                                                                      | 35/6000 [12:37<35:40:50, 21.53s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▍                                                                                                                                                                                                                                                      | 36/6000 [12:59<35:41:43, 21.55s/it]
An arbitrary loader is used instead of Validation loader


  1%|█▌                                                                                                                                                                                                                                                      | 37/6000 [13:20<35:40:06, 21.53s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▌                                                                                                                                                                                                                                                      | 38/6000 [13:42<35:45:02, 21.59s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|█▌                                                                                                                                                                                                                                                      | 39/6000 [14:03<35:44:55, 21.59s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▋                                                                                                                                                                                                                                                      | 40/6000 [14:26<36:17:40, 21.92s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▋                                                                                                                                                                                                                                                      | 41/6000 [14:48<36:06:07, 21.81s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▋                                                                                                                                                                                                                                                      | 42/6000 [15:09<35:57:57, 21.73s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▊                                                                                                                                                                                                                                                      | 43/6000 [15:31<35:56:59, 21.73s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▊                                                                                                                                                                                                                                                      | 44/6000 [15:52<35:47:00, 21.63s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▊                                                                                                                                                                                                                                                      | 45/6000 [16:14<35:45:40, 21.62s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▉                                                                                                                                                                                                                                                      | 46/6000 [16:35<35:40:19, 21.57s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▉                                                                                                                                                                                                                                                      | 47/6000 [16:57<35:39:14, 21.56s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|█▉                                                                                                                                                                                                                                                      | 48/6000 [17:18<35:39:46, 21.57s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██                                                                                                                                                                                                                                                      | 49/6000 [17:40<35:42:01, 21.60s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██                                                                                                                                                                                                                                                      | 50/6000 [18:02<35:43:11, 21.61s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|██                                                                                                                                                                                                                                                      | 51/6000 [18:23<35:45:28, 21.64s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|██▏                                                                                                                                                                                                                                                     | 52/6000 [18:45<35:46:54, 21.66s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▏                                                                                                                                                                                                                                                     | 53/6000 [19:07<35:50:24, 21.70s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▏                                                                                                                                                                                                                                                     | 54/6000 [19:28<35:44:37, 21.64s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▎                                                                                                                                                                                                                                                     | 55/6000 [19:50<35:43:02, 21.63s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|██▎                                                                                                                                                                                                                                                     | 56/6000 [20:12<35:43:21, 21.64s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|██▎                                                                                                                                                                                                                                                     | 57/6000 [20:33<35:41:21, 21.62s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▍                                                                                                                                                                                                                                                     | 58/6000 [20:55<35:39:09, 21.60s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|██▍                                                                                                                                                                                                                                                     | 59/6000 [21:16<35:38:59, 21.60s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▍                                                                                                                                                                                                                                                     | 60/6000 [21:38<35:38:23, 21.60s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▌                                                                                                                                                                                                                                                     | 61/6000 [22:00<35:38:08, 21.60s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|██▌                                                                                                                                                                                                                                                     | 62/6000 [22:21<35:27:53, 21.50s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|██▌                                                                                                                                                                                                                                                     | 63/6000 [22:44<36:10:15, 21.93s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▋                                                                                                                                                                                                                                                     | 64/6000 [23:06<36:03:02, 21.86s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▋                                                                                                                                                                                                                                                     | 65/6000 [23:27<35:54:48, 21.78s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▋                                                                                                                                                                                                                                                     | 66/6000 [23:49<35:48:25, 21.72s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▊                                                                                                                                                                                                                                                     | 67/6000 [24:10<35:41:53, 21.66s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▊                                                                                                                                                                                                                                                     | 68/6000 [24:32<35:40:01, 21.65s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▊                                                                                                                                                                                                                                                     | 69/6000 [24:54<35:40:35, 21.65s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|██▉                                                                                                                                                                                                                                                     | 70/6000 [25:15<35:42:25, 21.68s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|██▉                                                                                                                                                                                                                                                     | 71/6000 [25:37<35:45:50, 21.72s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▉                                                                                                                                                                                                                                                     | 72/6000 [25:59<35:53:30, 21.80s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|███                                                                                                                                                                                                                                                     | 73/6000 [26:21<35:47:07, 21.74s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|███                                                                                                                                                                                                                                                     | 74/6000 [26:42<35:45:26, 21.72s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|███                                                                                                                                                                                                                                                     | 75/6000 [27:04<35:41:58, 21.69s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|███▏                                                                                                                                                                                                                                                    | 76/6000 [27:26<35:42:08, 21.70s/it]
An arbitrary loader is used instead of Validation loader


  1%|███▏                                                                                                                                                                                                                                                    | 77/6000 [27:48<35:47:41, 21.76s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|███▏                                                                                                                                                                                                                                                    | 78/6000 [28:09<35:45:33, 21.74s/it]
An arbitrary loader is used instead of Validation loader


  1%|███▎                                                                                                                                                                                                                                                    | 79/6000 [28:31<35:47:04, 21.76s/it]
0.0005
An arbitrary loader is used instead of Validation loader


  1%|███▎                                                                                                                                                                                                                                                    | 80/6000 [28:53<35:47:19, 21.76s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▎                                                                                                                                                                                                                                                    | 81/6000 [29:14<35:39:06, 21.68s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  1%|███▍                                                                                                                                                                                                                                                    | 82/6000 [29:36<35:38:56, 21.69s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▍                                                                                                                                                                                                                                                    | 83/6000 [29:58<35:39:45, 21.70s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▍                                                                                                                                                                                                                                                    | 84/6000 [30:19<35:37:36, 21.68s/it]
0.0005
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▌                                                                                                                                                                                                                                                    | 85/6000 [30:41<35:37:06, 21.68s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|███▌                                                                                                                                                                                                                                                    | 86/6000 [31:03<35:38:55, 21.70s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|███▌                                                                                                                                                                                                                                                    | 87/6000 [31:26<36:09:10, 22.01s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▋                                                                                                                                                                                                                                                    | 88/6000 [31:47<35:59:03, 21.91s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|███▋                                                                                                                                                                                                                                                    | 89/6000 [32:09<35:46:54, 21.79s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  2%|███▋                                                                                                                                                                                                                                                    | 90/6000 [32:30<35:39:41, 21.72s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  2%|███▊                                                                                                                                                                                                                                                    | 91/6000 [32:52<35:30:43, 21.64s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  2%|███▊                                                                                                                                                                                                                                                    | 92/6000 [33:13<35:19:51, 21.53s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  2%|███▊                                                                                                                                                                                                                                                    | 93/6000 [33:34<35:10:07, 21.43s/it]
An arbitrary loader is used instead of Validation loader


  2%|███▉                                                                                                                                                                                                                                                    | 94/6000 [33:55<35:03:54, 21.37s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  2%|███▉                                                                                                                                                                                                                                                    | 95/6000 [34:17<35:00:08, 21.34s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  2%|███▉                                                                                                                                                                                                                                                    | 96/6000 [34:47<35:39:20, 21.74s/it]
Traceback (most recent call last):
  File "emb_train.py", line 162, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 81, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 124, in _train_by_single_batch
    loss, loss_dict = self.get_loss_pred_from_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 299, in get_loss_pred_from_single_batch
    loss = get_batch_contrastive_loss(emb1, emb2, self.margin)
  File "/home/clay/userdata/title_generation/emb_loss.py", line 17, in get_batch_contrastive_loss
    negative_sim = cos_sim_value[non_diag_index].reshape(num_batch, num_batch-1)
KeyboardInterrupt