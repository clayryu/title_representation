
  0%|                                                                                                                                                                                                                                                                    | 0/6000 [00:00<?, ?it/s]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.73s/it]
Saving the model with best validation loss: Epoch 1, Loss: 0.3000

  0%|                                                                                                                                                                                                                                                         | 1/6000 [00:17<29:30:28, 17.71s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.47s/it]
Saving the model with best validation loss: Epoch 2, Loss: 0.3000

  0%|                                                                                                                                                                                                                                                         | 2/6000 [00:35<29:18:11, 17.59s/it]
An arbitrary loader is used instead of Validation loader


  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 3, Loss: 0.2999

0.001
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.52s/it]
Saving the model with best validation loss: Epoch 4, Loss: 0.2998

  0%|▏                                                                                                                                                                                                                                                        | 4/6000 [01:10<29:12:27, 17.54s/it]
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.40s/it]
Saving the model with best validation loss: Epoch 5, Loss: 0.2995

  0%|▏                                                                                                                                                                                                                                                        | 5/6000 [01:28<29:21:45, 17.63s/it]
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.79s/it]
Saving the model with best validation loss: Epoch 6, Loss: 0.2994

  0%|▏                                                                                                                                                                                                                                                        | 6/6000 [01:46<29:37:10, 17.79s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 7, Loss: 0.2990

0.001
An arbitrary loader is used instead of Validation loader



  0%|▎                                                                                                                                                                                                                                                        | 8/6000 [02:21<29:28:26, 17.71s/it]
Saving the model with best validation loss: Epoch 8, Loss: 0.2983
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.37s/it]
Saving the model with best validation loss: Epoch 9, Loss: 0.2977

  0%|▎                                                                                                                                                                                                                                                        | 9/6000 [02:39<29:24:03, 17.67s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 10, Loss: 0.2967

0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|▍                                                                                                                                                                                                                                                       | 11/6000 [03:13<29:12:32, 17.56s/it]
Saving the model with best validation loss: Epoch 11, Loss: 0.2952
0.001
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 12, Loss: 0.2928

0.001
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.56s/it]
Saving the model with best validation loss: Epoch 13, Loss: 0.2915

  0%|▌                                                                                                                                                                                                                                                       | 13/6000 [03:48<29:00:15, 17.44s/it]
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.76s/it]

  0%|▌                                                                                                                                                                                                                                                       | 14/6000 [04:06<29:04:09, 17.48s/it]
An arbitrary loader is used instead of Validation loader



  0%|▌                                                                                                                                                                                                                                                       | 15/6000 [04:23<29:04:25, 17.49s/it]
Saving the model with best validation loss: Epoch 15, Loss: 0.2889
0.001
An arbitrary loader is used instead of Validation loader



  0%|▋                                                                                                                                                                                                                                                       | 16/6000 [04:41<29:20:05, 17.65s/it]
Saving the model with best validation loss: Epoch 16, Loss: 0.2874
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|▋                                                                                                                                                                                                                                                       | 17/6000 [05:00<29:54:13, 17.99s/it]
Saving the model with best validation loss: Epoch 17, Loss: 0.2856
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 18, Loss: 0.2850
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|▊                                                                                                                                                                                                                                                       | 19/6000 [05:35<29:34:25, 17.80s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|▊                                                                                                                                                                                                                                                       | 20/6000 [05:53<29:22:00, 17.68s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|▊                                                                                                                                                                                                                                                       | 21/6000 [06:10<29:09:14, 17.55s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.55s/it]

  0%|▉                                                                                                                                                                                                                                                       | 22/6000 [06:28<29:06:10, 17.53s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


  0%|▉                                                                                                                                                                                                                                                       | 23/6000 [06:45<29:01:12, 17.48s/it]
0.001
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.57s/it]

  0%|▉                                                                                                                                                                                                                                                       | 24/6000 [07:03<29:10:15, 17.57s/it]
An arbitrary loader is used instead of Validation loader



  0%|█                                                                                                                                                                                                                                                       | 25/6000 [07:20<28:49:52, 17.37s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  0%|█                                                                                                                                                                                                                                                       | 27/6000 [07:55<28:53:24, 17.41s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
0.001

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.77s/it]

  0%|█▏                                                                                                                                                                                                                                                      | 29/6000 [08:29<28:55:02, 17.43s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.40s/it]

  1%|█▎                                                                                                                                                                                                                                                      | 32/6000 [09:22<28:53:39, 17.43s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  1%|█▍                                                                                                                                                                                                                                                      | 34/6000 [09:57<29:01:49, 17.52s/it]
0.001
  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]



  1%|█▍                                                                                                                                                                                                                                                      | 35/6000 [10:15<29:12:53, 17.63s/it]
0.001
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

0.001
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.41s/it]

  1%|█▌                                                                                                                                                                                                                                                      | 37/6000 [10:50<29:11:41, 17.63s/it]
An arbitrary loader is used instead of Validation loader


 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 1/2 [00:05<00:05,  5.81s/it]

  1%|█▌                                                                                                                                                                                                                                                      | 38/6000 [11:12<29:18:00, 17.69s/it]
Traceback (most recent call last):
  File "emb_train.py", line 162, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 80, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 118, in _train_by_single_batch
    loss, loss_dict = self.get_loss_pred_from_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 293, in get_loss_pred_from_single_batch
    loss = get_batch_contrastive_loss(emb1, emb2, self.margin)
  File "/home/clay/userdata/title_generation/emb_loss.py", line 14, in get_batch_contrastive_loss
    non_diag_index = [x for x in range(num_batch) for y in range(num_batch) if x!=y], [y for x in range(len(cos_sim_value)) for y in range(len(cos_sim_value)) if x!=y]
  File "/home/clay/userdata/title_generation/emb_loss.py", line 14, in <listcomp>
    non_diag_index = [x for x in range(num_batch) for y in range(num_batch) if x!=y], [y for x in range(len(cos_sim_value)) for y in range(len(cos_sim_value)) if x!=y]
KeyboardInterrupt