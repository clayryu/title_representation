
  0%|                                                                                                                                                                                                                                                                           | 0/6000 [00:00<?, ?it/s]
0.0005
  0%|                                                                                                                                                                                                                                                                              | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
0.0005

  0%|                                                                                                                                                                                                                                                                 | 2/6000 [00:11<8:36:35,  5.17s/it]

  0%|▏                                                                                                                                                                                                                                                                | 3/6000 [00:14<7:17:57,  4.38s/it]

  0%|▏                                                                                                                                                                                                                                                                | 4/6000 [00:17<6:41:02,  4.01s/it]


  0%|▎                                                                                                                                                                                                                                                                | 6/6000 [00:24<6:05:30,  3.66s/it]
0.0005

  0%|▎                                                                                                                                                                                                                                                                | 7/6000 [00:28<5:58:49,  3.59s/it]

  0%|▎                                                                                                                                                                                                                                                                | 8/6000 [00:31<5:52:57,  3.53s/it]

  0%|▍                                                                                                                                                                                                                                                                | 9/6000 [00:34<5:48:57,  3.49s/it]


  0%|▍                                                                                                                                                                                                                                                               | 11/6000 [00:41<5:44:13,  3.45s/it]

  0%|▌                                                                                                                                                                                                                                                               | 12/6000 [00:45<5:43:44,  3.44s/it]

  0%|▌                                                                                                                                                                                                                                                               | 13/6000 [00:48<5:42:18,  3.43s/it]

  0%|▌                                                                                                                                                                                                                                                               | 14/6000 [00:52<5:41:17,  3.42s/it]

  0%|▋                                                                                                                                                                                                                                                               | 15/6000 [00:55<5:40:41,  3.42s/it]

  0%|▋                                                                                                                                                                                                                                                               | 16/6000 [00:58<5:40:21,  3.41s/it]

  0%|▋                                                                                                                                                                                                                                                               | 17/6000 [01:02<5:40:32,  3.42s/it]

  0%|▊                                                                                                                                                                                                                                                               | 18/6000 [01:05<5:42:21,  3.43s/it]

  0%|▊                                                                                                                                                                                                                                                               | 19/6000 [01:09<5:43:31,  3.45s/it]

  0%|▊                                                                                                                                                                                                                                                               | 20/6000 [01:12<5:44:05,  3.45s/it]

  0%|▉                                                                                                                                                                                                                                                               | 21/6000 [01:16<5:45:29,  3.47s/it]

  0%|▉                                                                                                                                                                                                                                                               | 22/6000 [01:19<5:43:58,  3.45s/it]

  0%|▉                                                                                                                                                                                                                                                               | 23/6000 [01:23<5:42:36,  3.44s/it]

  0%|█                                                                                                                                                                                                                                                               | 24/6000 [01:26<5:42:46,  3.44s/it]
0.0005


  0%|█                                                                                                                                                                                                                                                               | 26/6000 [01:33<5:43:11,  3.45s/it]

  0%|█▏                                                                                                                                                                                                                                                              | 27/6000 [01:37<5:53:34,  3.55s/it]

  0%|█▏                                                                                                                                                                                                                                                              | 28/6000 [01:40<5:49:26,  3.51s/it]

  0%|█▏                                                                                                                                                                                                                                                              | 29/6000 [01:43<5:46:18,  3.48s/it]

  0%|█▎                                                                                                                                                                                                                                                              | 30/6000 [01:47<5:44:51,  3.47s/it]

  1%|█▎                                                                                                                                                                                                                                                              | 31/6000 [01:50<5:42:57,  3.45s/it]

  1%|█▎                                                                                                                                                                                                                                                              | 32/6000 [01:54<5:41:46,  3.44s/it]

  1%|█▍                                                                                                                                                                                                                                                              | 33/6000 [01:57<5:41:02,  3.43s/it]

  1%|█▍                                                                                                                                                                                                                                                              | 34/6000 [02:01<5:40:14,  3.42s/it]

  1%|█▍                                                                                                                                                                                                                                                              | 35/6000 [02:04<5:39:37,  3.42s/it]

  1%|█▌                                                                                                                                                                                                                                                              | 36/6000 [02:07<5:39:12,  3.41s/it]
0.0005


  1%|█▌                                                                                                                                                                                                                                                              | 38/6000 [02:14<5:38:38,  3.41s/it]

  1%|█▋                                                                                                                                                                                                                                                              | 39/6000 [02:18<5:38:13,  3.40s/it]

  1%|█▋                                                                                                                                                                                                                                                              | 40/6000 [02:21<5:38:12,  3.40s/it]

  1%|█▋                                                                                                                                                                                                                                                              | 41/6000 [02:24<5:38:03,  3.40s/it]

  1%|█▊                                                                                                                                                                                                                                                              | 42/6000 [02:28<5:37:50,  3.40s/it]
0.0005


  1%|█▉                                                                                                                                                                                                                                                              | 44/6000 [02:35<5:37:50,  3.40s/it]

  1%|█▉                                                                                                                                                                                                                                                              | 45/6000 [02:38<5:37:48,  3.40s/it]

  1%|█▉                                                                                                                                                                                                                                                              | 46/6000 [02:41<5:37:46,  3.40s/it]

  1%|██                                                                                                                                                                                                                                                              | 47/6000 [02:45<5:37:46,  3.40s/it]

  1%|██                                                                                                                                                                                                                                                              | 48/6000 [02:48<5:39:03,  3.42s/it]
0.0005


  1%|██▏                                                                                                                                                                                                                                                             | 50/6000 [02:55<5:40:35,  3.43s/it]

  1%|██▏                                                                                                                                                                                                                                                             | 51/6000 [02:59<5:40:38,  3.44s/it]

  1%|██▏                                                                                                                                                                                                                                                             | 52/6000 [03:02<5:39:28,  3.42s/it]

  1%|██▎                                                                                                                                                                                                                                                             | 53/6000 [03:05<5:38:43,  3.42s/it]

  1%|██▎                                                                                                                                                                                                                                                             | 54/6000 [03:09<5:38:06,  3.41s/it]
0.0005


  1%|██▍                                                                                                                                                                                                                                                             | 56/6000 [03:16<5:37:35,  3.41s/it]

  1%|██▍                                                                                                                                                                                                                                                             | 57/6000 [03:19<5:37:26,  3.41s/it]

  1%|██▍                                                                                                                                                                                                                                                             | 58/6000 [03:22<5:38:01,  3.41s/it]

  1%|██▌                                                                                                                                                                                                                                                             | 59/6000 [03:26<5:39:26,  3.43s/it]

  1%|██▌                                                                                                                                                                                                                                                             | 60/6000 [03:29<5:39:26,  3.43s/it]
0.0005


  1%|██▋                                                                                                                                                                                                                                                             | 62/6000 [03:36<5:38:24,  3.42s/it]

  1%|██▋                                                                                                                                                                                                                                                             | 63/6000 [03:40<5:38:00,  3.42s/it]

  1%|██▋                                                                                                                                                                                                                                                             | 64/6000 [03:43<5:37:42,  3.41s/it]

  1%|██▊                                                                                                                                                                                                                                                             | 65/6000 [03:47<5:47:49,  3.52s/it]

  1%|██▊                                                                                                                                                                                                                                                             | 66/6000 [03:50<5:44:40,  3.49s/it]
0.0005

  1%|██▊                                                                                                                                                                                                                                                             | 67/6000 [03:54<5:42:20,  3.46s/it]


  1%|██▉                                                                                                                                                                                                                                                             | 69/6000 [04:00<5:39:17,  3.43s/it]

  1%|██▉                                                                                                                                                                                                                                                             | 70/6000 [04:04<5:38:22,  3.42s/it]

  1%|███                                                                                                                                                                                                                                                             | 71/6000 [04:07<5:37:52,  3.42s/it]

  1%|███                                                                                                                                                                                                                                                             | 72/6000 [04:11<5:37:36,  3.42s/it]
0.0005

  1%|███                                                                                                                                                                                                                                                             | 73/6000 [04:14<5:37:04,  3.41s/it]


  1%|███▏                                                                                                                                                                                                                                                            | 75/6000 [04:21<5:37:43,  3.42s/it]

  1%|███▏                                                                                                                                                                                                                                                            | 76/6000 [04:24<5:37:37,  3.42s/it]

  1%|███▎                                                                                                                                                                                                                                                            | 77/6000 [04:28<5:37:30,  3.42s/it]

  1%|███▎                                                                                                                                                                                                                                                            | 78/6000 [04:31<5:37:15,  3.42s/it]
0.0005

  1%|███▎                                                                                                                                                                                                                                                            | 79/6000 [04:34<5:36:54,  3.41s/it]


  1%|███▍                                                                                                                                                                                                                                                            | 81/6000 [04:41<5:36:45,  3.41s/it]

  1%|███▍                                                                                                                                                                                                                                                            | 82/6000 [04:45<5:37:00,  3.42s/it]

  1%|███▌                                                                                                                                                                                                                                                            | 83/6000 [04:48<5:36:55,  3.42s/it]

  1%|███▌                                                                                                                                                                                                                                                            | 84/6000 [04:52<5:36:23,  3.41s/it]
0.0005

  1%|███▋                                                                                                                                                                                                                                                            | 85/6000 [04:55<5:36:03,  3.41s/it]


  1%|███▋                                                                                                                                                                                                                                                            | 87/6000 [05:02<5:35:25,  3.40s/it]

  1%|███▊                                                                                                                                                                                                                                                            | 88/6000 [05:05<5:35:23,  3.40s/it]
0.0005


  2%|███▊                                                                                                                                                                                                                                                            | 90/6000 [05:12<5:35:21,  3.40s/it]
0.0005


  2%|███▉                                                                                                                                                                                                                                                            | 92/6000 [05:19<5:36:15,  3.41s/it]

  2%|███▉                                                                                                                                                                                                                                                            | 93/6000 [05:22<5:36:08,  3.41s/it]

  2%|████                                                                                                                                                                                                                                                            | 94/6000 [05:26<5:35:57,  3.41s/it]
0.0005


  2%|████                                                                                                                                                                                                                                                            | 96/6000 [05:32<5:35:48,  3.41s/it]
0.0005


  2%|████▏                                                                                                                                                                                                                                                           | 98/6000 [05:39<5:35:39,  3.41s/it]

  2%|████▏                                                                                                                                                                                                                                                           | 99/6000 [05:43<5:35:38,  3.41s/it]

  2%|████▎                                                                                                                                                                                                                                                          | 100/6000 [05:46<5:35:19,  3.41s/it]
0.0005
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                              | 0/1 [00:00<?, ?it/s]

  2%|████▎                                                                                                                                                                                                                                                          | 102/6000 [05:57<7:00:17,  4.28s/it]

  2%|████▍                                                                                                                                                                                                                                                          | 103/6000 [06:01<6:45:52,  4.13s/it]
0.0005


  2%|████▍                                                                                                                                                                                                                                                          | 105/6000 [06:08<6:10:44,  3.77s/it]

  2%|████▌                                                                                                                                                                                                                                                          | 106/6000 [06:11<6:00:32,  3.67s/it]

  2%|████▌                                                                                                                                                                                                                                                          | 107/6000 [06:15<5:53:49,  3.60s/it]

  2%|████▌                                                                                                                                                                                                                                                          | 108/6000 [06:18<5:48:04,  3.54s/it]

  2%|████▋                                                                                                                                                                                                                                                          | 109/6000 [06:21<5:43:51,  3.50s/it]
0.0005


  2%|████▋                                                                                                                                                                                                                                                          | 111/6000 [06:28<5:39:53,  3.46s/it]

  2%|████▊                                                                                                                                                                                                                                                          | 112/6000 [06:32<5:38:18,  3.45s/it]

  2%|████▊                                                                                                                                                                                                                                                          | 113/6000 [06:35<5:38:14,  3.45s/it]

  2%|████▊                                                                                                                                                                                                                                                          | 114/6000 [06:38<5:37:17,  3.44s/it]

  2%|████▉                                                                                                                                                                                                                                                          | 115/6000 [06:42<5:36:26,  3.43s/it]
0.0005


  2%|████▉                                                                                                                                                                                                                                                          | 117/6000 [06:49<5:35:03,  3.42s/it]

  2%|█████                                                                                                                                                                                                                                                          | 118/6000 [06:52<5:34:34,  3.41s/it]

  2%|█████                                                                                                                                                                                                                                                          | 119/6000 [06:55<5:34:09,  3.41s/it]

  2%|█████                                                                                                                                                                                                                                                          | 120/6000 [06:59<5:34:39,  3.41s/it]

  2%|█████▏                                                                                                                                                                                                                                                         | 121/6000 [07:02<5:34:25,  3.41s/it]
0.0005


  2%|█████▏                                                                                                                                                                                                                                                         | 123/6000 [07:09<5:33:51,  3.41s/it]

  2%|█████▎                                                                                                                                                                                                                                                         | 124/6000 [07:13<5:34:15,  3.41s/it]

  2%|█████▎                                                                                                                                                                                                                                                         | 125/6000 [07:16<5:34:07,  3.41s/it]

  2%|█████▎                                                                                                                                                                                                                                                         | 126/6000 [07:19<5:34:23,  3.42s/it]

  2%|█████▍                                                                                                                                                                                                                                                         | 127/6000 [07:23<5:34:16,  3.41s/it]
0.0005


  2%|█████▍                                                                                                                                                                                                                                                         | 129/6000 [07:30<5:34:09,  3.41s/it]

  2%|█████▌                                                                                                                                                                                                                                                         | 130/6000 [07:33<5:34:53,  3.42s/it]

  2%|█████▌                                                                                                                                                                                                                                                         | 131/6000 [07:36<5:34:07,  3.42s/it]

  2%|█████▌                                                                                                                                                                                                                                                         | 132/6000 [07:40<5:34:08,  3.42s/it]

  2%|█████▋                                                                                                                                                                                                                                                         | 133/6000 [07:43<5:34:00,  3.42s/it]
0.0005


  2%|█████▋                                                                                                                                                                                                                                                         | 135/6000 [07:50<5:33:04,  3.41s/it]

  2%|█████▊                                                                                                                                                                                                                                                         | 136/6000 [07:54<5:45:30,  3.54s/it]

  2%|█████▊                                                                                                                                                                                                                                                         | 137/6000 [07:57<5:44:48,  3.53s/it]

  2%|█████▊                                                                                                                                                                                                                                                         | 138/6000 [08:01<5:44:54,  3.53s/it]

  2%|█████▉                                                                                                                                                                                                                                                         | 139/6000 [08:04<5:44:27,  3.53s/it]

  2%|█████▉                                                                                                                                                                                                                                                         | 140/6000 [08:08<5:43:55,  3.52s/it]
0.0005


  2%|██████                                                                                                                                                                                                                                                         | 142/6000 [08:15<5:43:04,  3.51s/it]

  2%|██████                                                                                                                                                                                                                                                         | 143/6000 [08:18<5:41:44,  3.50s/it]

  2%|██████                                                                                                                                                                                                                                                         | 144/6000 [08:22<5:40:58,  3.49s/it]

  2%|██████▏                                                                                                                                                                                                                                                        | 145/6000 [08:25<5:40:19,  3.49s/it]

  2%|██████▏                                                                                                                                                                                                                                                        | 146/6000 [08:29<5:39:19,  3.48s/it]

  2%|██████▏                                                                                                                                                                                                                                                        | 147/6000 [08:32<5:38:59,  3.48s/it]
0.0005


  2%|██████▎                                                                                                                                                                                                                                                        | 149/6000 [08:39<5:39:28,  3.48s/it]

  2%|██████▍                                                                                                                                                                                                                                                        | 150/6000 [08:43<5:38:58,  3.48s/it]
0.0005

  3%|██████▍                                                                                                                                                                                                                                                        | 151/6000 [08:46<5:38:04,  3.47s/it]


  3%|██████▌                                                                                                                                                                                                                                                        | 153/6000 [08:53<5:37:52,  3.47s/it]

  3%|██████▌                                                                                                                                                                                                                                                        | 154/6000 [08:57<5:37:32,  3.46s/it]

  3%|██████▌                                                                                                                                                                                                                                                        | 155/6000 [09:00<5:37:07,  3.46s/it]

  3%|██████▋                                                                                                                                                                                                                                                        | 156/6000 [09:04<5:37:10,  3.46s/it]
0.0005

  3%|██████▋                                                                                                                                                                                                                                                        | 157/6000 [09:07<5:36:58,  3.46s/it]


  3%|██████▊                                                                                                                                                                                                                                                        | 159/6000 [09:14<5:36:43,  3.46s/it]

  3%|██████▊                                                                                                                                                                                                                                                        | 160/6000 [09:17<5:36:48,  3.46s/it]

  3%|██████▊                                                                                                                                                                                                                                                        | 161/6000 [09:21<5:36:29,  3.46s/it]

  3%|██████▉                                                                                                                                                                                                                                                        | 162/6000 [09:24<5:36:03,  3.45s/it]
0.0005

  3%|██████▉                                                                                                                                                                                                                                                        | 163/6000 [09:28<5:36:42,  3.46s/it]


  3%|███████                                                                                                                                                                                                                                                        | 165/6000 [09:35<5:36:12,  3.46s/it]

  3%|███████                                                                                                                                                                                                                                                        | 166/6000 [09:38<5:36:24,  3.46s/it]

  3%|███████                                                                                                                                                                                                                                                        | 167/6000 [09:42<5:36:45,  3.46s/it]

  3%|███████▏                                                                                                                                                                                                                                                       | 168/6000 [09:45<5:36:14,  3.46s/it]

  3%|███████▏                                                                                                                                                                                                                                                       | 169/6000 [09:49<5:46:04,  3.56s/it]
0.0005


  3%|███████▎                                                                                                                                                                                                                                                       | 171/6000 [09:56<5:40:54,  3.51s/it]

  3%|███████▎                                                                                                                                                                                                                                                       | 172/6000 [09:59<5:39:39,  3.50s/it]

  3%|███████▎                                                                                                                                                                                                                                                       | 173/6000 [10:03<5:38:52,  3.49s/it]

  3%|███████▍                                                                                                                                                                                                                                                       | 174/6000 [10:06<5:38:51,  3.49s/it]

  3%|███████▍                                                                                                                                                                                                                                                       | 175/6000 [10:10<5:37:32,  3.48s/it]
0.0005


  3%|███████▌                                                                                                                                                                                                                                                       | 177/6000 [10:17<5:36:45,  3.47s/it]

  3%|███████▌                                                                                                                                                                                                                                                       | 178/6000 [10:20<5:36:37,  3.47s/it]

  3%|███████▌                                                                                                                                                                                                                                                       | 179/6000 [10:23<5:36:14,  3.47s/it]

  3%|███████▋                                                                                                                                                                                                                                                       | 180/6000 [10:27<5:36:04,  3.46s/it]

  3%|███████▋                                                                                                                                                                                                                                                       | 181/6000 [10:30<5:35:37,  3.46s/it]
0.0005


  3%|███████▊                                                                                                                                                                                                                                                       | 183/6000 [10:37<5:35:08,  3.46s/it]

  3%|███████▊                                                                                                                                                                                                                                                       | 184/6000 [10:41<5:35:01,  3.46s/it]

  3%|███████▊                                                                                                                                                                                                                                                       | 185/6000 [10:44<5:34:54,  3.46s/it]

  3%|███████▉                                                                                                                                                                                                                                                       | 186/6000 [10:48<5:35:00,  3.46s/it]

  3%|███████▉                                                                                                                                                                                                                                                       | 187/6000 [10:51<5:35:05,  3.46s/it]
0.0005


  3%|████████                                                                                                                                                                                                                                                       | 189/6000 [10:58<5:34:36,  3.45s/it]

  3%|████████                                                                                                                                                                                                                                                       | 190/6000 [11:02<5:34:36,  3.46s/it]

  3%|████████                                                                                                                                                                                                                                                       | 191/6000 [11:05<5:34:39,  3.46s/it]

  3%|████████▏                                                                                                                                                                                                                                                      | 192/6000 [11:08<5:34:36,  3.46s/it]

  3%|████████▏                                                                                                                                                                                                                                                      | 193/6000 [11:12<5:34:47,  3.46s/it]
0.0005


  3%|████████▎                                                                                                                                                                                                                                                      | 195/6000 [11:19<5:34:30,  3.46s/it]

  3%|████████▎                                                                                                                                                                                                                                                      | 196/6000 [11:22<5:34:39,  3.46s/it]

  3%|████████▎                                                                                                                                                                                                                                                      | 197/6000 [11:26<5:34:26,  3.46s/it]

  3%|████████▍                                                                                                                                                                                                                                                      | 198/6000 [11:29<5:35:22,  3.47s/it]

  3%|████████▍                                                                                                                                                                                                                                                      | 199/6000 [11:33<5:35:55,  3.47s/it]
0.0005

  3%|████████▌                                                                                                                                                                                                                                                      | 200/6000 [11:36<5:35:37,  3.47s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                              | 0/1 [00:00<?, ?it/s]


  3%|████████▌                                                                                                                                                                                                                                                      | 202/6000 [11:47<7:04:19,  4.39s/it]

  3%|████████▋                                                                                                                                                                                                                                                      | 203/6000 [11:51<6:37:17,  4.11s/it]
0.0005

  3%|████████▋                                                                                                                                                                                                                                                      | 204/6000 [11:54<6:19:26,  3.93s/it]


  3%|████████▊                                                                                                                                                                                                                                                      | 206/6000 [12:01<5:56:34,  3.69s/it]

  3%|████████▊                                                                                                                                                                                                                                                      | 207/6000 [12:05<5:49:44,  3.62s/it]

  3%|████████▊                                                                                                                                                                                                                                                      | 208/6000 [12:08<5:45:21,  3.58s/it]

  3%|████████▉                                                                                                                                                                                                                                                      | 209/6000 [12:12<5:42:05,  3.54s/it]

  4%|████████▉                                                                                                                                                                                                                                                      | 210/6000 [12:15<5:39:29,  3.52s/it]
0.0005

  4%|████████▉                                                                                                                                                                                                                                                      | 211/6000 [12:22<5:39:19,  3.52s/it]
Traceback (most recent call last):
  File "emb_train.py", line 162, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 81, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 143, in _train_by_single_batch
    loss, loss_dict = self.get_loss_pred_from_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 318, in get_loss_pred_from_single_batch
    loss = get_batch_contrastive_loss(emb1, emb2, self.margin)
  File "/home/clay/userdata/title_generation/emb_loss.py", line 17, in get_batch_contrastive_loss
    negative_sim = cos_sim_value[non_diag_index].reshape(num_batch, num_batch-1)
KeyboardInterrupt