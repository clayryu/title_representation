
  0%|                                                                                                                                                                                                                                                                        | 0/500 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader



 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 5/8 [00:04<00:02,  1.19it/s]

  0%|▌                                                                                                                                                                                                                                                             | 1/500 [00:14<2:01:24, 14.60s/it]
An arbitrary loader is used instead of Validation loader



 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 5/8 [00:04<00:02,  1.23it/s]

  0%|█                                                                                                                                                                                                                                                             | 2/500 [00:28<1:59:42, 14.42s/it]
An arbitrary loader is used instead of Validation loader



 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 5/8 [00:03<00:02,  1.26it/s]

  1%|█▌                                                                                                                                                                                                                                                            | 3/500 [00:43<1:58:33, 14.31s/it]
An arbitrary loader is used instead of Validation loader



 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 5/8 [00:04<00:02,  1.22it/s]

  1%|██                                                                                                                                                                                                                                                            | 4/500 [00:57<1:58:02, 14.28s/it]
An arbitrary loader is used instead of Validation loader



 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 5/8 [00:03<00:02,  1.23it/s]

  1%|██▌                                                                                                                                                                                                                                                           | 5/500 [01:11<1:56:51, 14.17s/it]
  0%|                                                                                                                                                                                                                                                                          | 0/8 [00:00<?, ?it/s]




  1%|███                                                                                                                                                                                                                                                           | 6/500 [01:25<1:56:02, 14.09s/it]
An arbitrary loader is used instead of Validation loader




  1%|███▌                                                                                                                                                                                                                                                          | 7/500 [01:39<1:55:25, 14.05s/it]
An arbitrary loader is used instead of Validation loader




  2%|████                                                                                                                                                                                                                                                          | 8/500 [01:53<1:55:40, 14.11s/it]
  0%|                                                                                                                                                                                                                                                                          | 0/8 [00:00<?, ?it/s]




  2%|████▌                                                                                                                                                                                                                                                         | 9/500 [02:07<1:55:31, 14.12s/it]
  0%|                                                                                                                                                                                                                                                                          | 0/8 [00:00<?, ?it/s]




  2%|█████                                                                                                                                                                                                                                                        | 10/500 [02:21<1:55:17, 14.12s/it]
  0%|                                                                                                                                                                                                                                                                          | 0/8 [00:00<?, ?it/s]




  2%|█████▌                                                                                                                                                                                                                                                       | 11/500 [02:35<1:55:10, 14.13s/it]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  4%|█████████▌                                                                                                                                                                                                                                                   | 19/500 [04:29<1:53:24, 14.15s/it]
An arbitrary loader is used instead of Validation loader




  4%|██████████                                                                                                                                                                                                                                                   | 20/500 [04:43<1:53:15, 14.16s/it]
An arbitrary loader is used instead of Validation loader




  4%|██████████▋                                                                                                                                                                                                                                                  | 21/500 [04:57<1:52:48, 14.13s/it]
An arbitrary loader is used instead of Validation loader




  4%|███████████▏                                                                                                                                                                                                                                                 | 22/500 [05:11<1:52:32, 14.13s/it]
An arbitrary loader is used instead of Validation loader




  5%|███████████▋                                                                                                                                                                                                                                                 | 23/500 [05:25<1:52:05, 14.10s/it]
An arbitrary loader is used instead of Validation loader




  5%|████████████▏                                                                                                                                                                                                                                                | 24/500 [05:39<1:51:48, 14.09s/it]
An arbitrary loader is used instead of Validation loader




  5%|████████████▋                                                                                                                                                                                                                                                | 25/500 [05:53<1:51:09, 14.04s/it]
An arbitrary loader is used instead of Validation loader




  5%|█████████████▏                                                                                                                                                                                                                                               | 26/500 [06:07<1:51:11, 14.07s/it]
An arbitrary loader is used instead of Validation loader




  5%|█████████████▋                                                                                                                                                                                                                                               | 27/500 [06:21<1:50:52, 14.06s/it]
An arbitrary loader is used instead of Validation loader




  6%|██████████████▏                                                                                                                                                                                                                                              | 28/500 [06:36<1:51:10, 14.13s/it]
An arbitrary loader is used instead of Validation loader




 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 7/8 [00:05<00:00,  1.22it/s]
An arbitrary loader is used instead of Validation loader



 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                | 6/8 [00:04<00:01,  1.28it/s]
An arbitrary loader is used instead of Validation loader



 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                | 6/8 [00:04<00:01,  1.23it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader




  0%|                                                                                                                                                                                                                                                                          | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader



 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                | 6/8 [00:04<00:01,  1.23it/s]
An arbitrary loader is used instead of Validation loader



 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                | 6/8 [00:04<00:01,  1.24it/s]
An arbitrary loader is used instead of Validation loader



 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 7/8 [00:05<00:00,  1.23it/s]
  0%|                                                                                                                                                                                                                                                                          | 0/8 [00:00<?, ?it/s]




 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 7/8 [00:05<00:00,  1.23it/s]
An arbitrary loader is used instead of Validation loader



 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 7/8 [00:05<00:00,  1.28it/s]
An arbitrary loader is used instead of Validation loader

Traceback (most recent call last):
  File "emb_train.py", line 139, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 90, in train_by_num_epoch
    train_loss, train_acc = self.validate(external_loader=self.train_loader)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 379, in validate
    emb1 = self.abc_model(melody.to(self.device), measure_numbers.to(self.device))
  File "/home/clay/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/clay/userdata/title_generation/emb_model.py", line 45, in forward
    measure_hidden = self.measure_rnn(hidden, measure_numbers)
  File "/home/clay/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/clay/userdata/title_generation/module.py", line 18, in forward
    measure_nodes = make_higher_node(padded_x, self.attention, measure_numbers, measure_numbers,
  File "/home/clay/userdata/title_generation/model_utils.py", line 54, in make_higher_node
    boundaries = find_boundaries_batch(higher_indices)
  File "/home/clay/userdata/title_generation/model_utils.py", line 22, in find_boundaries_batch
    return [find_boundaries(diff_boundary, beat_numbers, i) for i in range(len(beat_numbers))]
  File "/home/clay/userdata/title_generation/model_utils.py", line 22, in <listcomp>
    return [find_boundaries(diff_boundary, beat_numbers, i) for i in range(len(beat_numbers))]
  File "/home/clay/userdata/title_generation/model_utils.py", line 12, in find_boundaries
    out = [0] + (diff_boundary[diff_boundary[:,0]==i][:,1]+1 ).tolist() + [torch.max(torch.nonzero(higher_indices[i])).item()+1]
KeyboardInterrupt