
0.0004
  0%|                                                                                                                                                                                                                                                          | 0/9000 [00:00<?, ?it/s]
batch_time: 3.9022583961486816
get_batch_contrastive_loss time: 2.700267791748047
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                             | 0/1 [00:00<?, ?it/s]

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.07s/it]
0.0004

  0%|                                                                                                                                                                                                                                               | 2/9000 [00:24<28:13:45, 11.29s/it]
get_batch_contrastive_loss time: 1.1225996017456055
0.0004

  0%|                                                                                                                                                                                                                                               | 3/9000 [00:30<22:20:57,  8.94s/it]
get_batch_contrastive_loss time: 1.1478519439697266
0.0004

  0%|                                                                                                                                                                                                                                               | 4/9000 [00:37<19:46:19,  7.91s/it]
get_batch_contrastive_loss time: 1.1198170185089111
0.0004

  0%|▏                                                                                                                                                                                                                                              | 5/9000 [00:43<18:02:00,  7.22s/it]
get_batch_contrastive_loss time: 1.1166198253631592
0.0004

  0%|▏                                                                                                                                                                                                                                              | 6/9000 [00:49<16:57:11,  6.79s/it]
get_batch_contrastive_loss time: 1.1142339706420898
0.0004
  0%|▏                                                                                                                                                                                                                                              | 6/9000 [00:54<22:40:27,  9.08s/it]
Traceback (most recent call last):
  File "emb_train.py", line 167, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 90, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch, reg_abc_loss=None, reg_ttl_loss=None)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 153, in _train_by_single_batch
    loss, loss_dict = self.get_loss_pred_from_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 334, in get_loss_pred_from_single_batch
    loss = self.loss_fn(emb1, emb2)
  File "/home/clay/userdata/title_generation/emb_loss.py", line 13, in __call__
    return self.get_batch_contrastive_loss(emb1, emb2)
  File "/home/clay/userdata/title_generation/emb_loss.py", line 31, in get_batch_contrastive_loss
    negative_sim = cos_sim_value[non_diag_index].reshape(num_batch, num_batch-1)
KeyboardInterrupt