
  0%|                                                                                                                                                                                                                                                                    | 0/3000 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

Saving the model with best validation loss: Epoch 1, Loss: 0.3000
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|▏                                                                                                                                                                                                                                                         | 2/3000 [00:22<9:33:14, 11.47s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▎                                                                                                                                                                                                                                                         | 3/3000 [00:34<9:37:31, 11.56s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▌                                                                                                                                                                                                                                                         | 6/3000 [01:09<9:36:39, 11.56s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
Saving the model with best validation loss: Epoch 7, Loss: 0.2999
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 8, Loss: 0.2999
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  0%|▊                                                                                                                                                                                                                                                         | 9/3000 [01:44<9:41:17, 11.66s/it]
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 10, Loss: 0.2998
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 11, Loss: 0.2997
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 12, Loss: 0.2997
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  0%|█                                                                                                                                                                                                                                                        | 13/3000 [02:30<9:38:12, 11.61s/it]
Saving the model with best validation loss: Epoch 13, Loss: 0.2994
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
Saving the model with best validation loss: Epoch 14, Loss: 0.2993
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 15, Loss: 0.2990
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

  1%|█▎                                                                                                                                                                                                                                                       | 16/3000 [03:05<9:33:36, 11.53s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
Saving the model with best validation loss: Epoch 17, Loss: 0.2981
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
Saving the model with best validation loss: Epoch 18, Loss: 0.2973
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▌                                                                                                                                                                                                                                                       | 19/3000 [03:39<9:32:49, 11.53s/it]
Saving the model with best validation loss: Epoch 19, Loss: 0.2963
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▋                                                                                                                                                                                                                                                       | 20/3000 [03:51<9:37:47, 11.63s/it]
Saving the model with best validation loss: Epoch 20, Loss: 0.2954
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
Saving the model with best validation loss: Epoch 21, Loss: 0.2931
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|█▊                                                                                                                                                                                                                                                       | 22/3000 [04:14<9:32:37, 11.54s/it]
Saving the model with best validation loss: Epoch 22, Loss: 0.2910
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 23, Loss: 0.2890
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 24, Loss: 0.2866
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 25, Loss: 0.2842
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 26, Loss: 0.2840
An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

Saving the model with best validation loss: Epoch 27, Loss: 0.2835
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▎                                                                                                                                                                                                                                                      | 28/3000 [05:23<9:26:33, 11.44s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|██▌                                                                                                                                                                                                                                                      | 31/3000 [05:57<9:25:49, 11.43s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader


  1%|██▊                                                                                                                                                                                                                                                      | 34/3000 [06:32<9:27:20, 11.48s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  1%|██▉                                                                                                                                                                                                                                                      | 36/3000 [06:54<9:22:45, 11.39s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader


  1%|███▏                                                                                                                                                                                                                                                     | 38/3000 [07:17<9:19:02, 11.32s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  1%|███▎                                                                                                                                                                                                                                                     | 40/3000 [07:39<9:16:29, 11.28s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader


  1%|███▍                                                                                                                                                                                                                                                     | 42/3000 [08:02<9:14:38, 11.25s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  2%|███▉                                                                                                                                                                                                                                                     | 47/3000 [08:58<9:17:59, 11.34s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  2%|████▏                                                                                                                                                                                                                                                    | 50/3000 [09:33<9:20:51, 11.41s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  2%|████▍                                                                                                                                                                                                                                                    | 53/3000 [10:07<9:21:22, 11.43s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  2%|████▌                                                                                                                                                                                                                                                    | 55/3000 [10:30<9:16:13, 11.33s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  2%|████▊                                                                                                                                                                                                                                                    | 58/3000 [11:03<9:14:44, 11.31s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  2%|█████                                                                                                                                                                                                                                                    | 61/3000 [11:38<9:23:08, 11.50s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  2%|█████▎                                                                                                                                                                                                                                                   | 64/3000 [12:13<9:22:04, 11.49s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader


  2%|█████▌                                                                                                                                                                                                                                                   | 67/3000 [12:47<9:16:43, 11.39s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  2%|█████▋                                                                                                                                                                                                                                                   | 69/3000 [13:09<9:11:34, 11.29s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  3%|██████▎                                                                                                                                                                                                                                                  | 76/3000 [14:29<9:10:17, 11.29s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  3%|██████▋                                                                                                                                                                                                                                                  | 81/3000 [15:25<9:08:21, 11.27s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  3%|██████▉                                                                                                                                                                                                                                                  | 83/3000 [15:48<9:08:15, 11.28s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  3%|██████▉                                                                                                                                                                                                                                                  | 84/3000 [15:59<9:14:38, 11.41s/it]
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]

An arbitrary loader is used instead of Validation loader
  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]


  3%|███████▏                                                                                                                                                                                                                                                 | 86/3000 [16:22<9:13:02, 11.39s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  3%|███████▍                                                                                                                                                                                                                                                 | 89/3000 [16:56<9:14:09, 11.42s/it]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                                                       | 0/1 [00:00<?, ?it/s]
An arbitrary loader is used instead of Validation loader


  3%|███████▋                                                                                                                                                                                                                                                 | 92/3000 [17:35<9:16:16, 11.48s/it]
Traceback (most recent call last):
  File "emb_train.py", line 159, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 84, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 134, in _train_by_single_batch
    loss, loss_dict = self.get_loss_pred_from_single_batch(batch)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 296, in get_loss_pred_from_single_batch
    loss = get_batch_contrastive_loss(emb1, emb2)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 31, in get_batch_contrastive_loss
    negative_sim = cos_sim_value[non_diag_index].reshape(num_batch, num_batch-1)
KeyboardInterrupt