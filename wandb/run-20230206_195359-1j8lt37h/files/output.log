
  0%|                                                                                                                                                                                                                                                          | 0/9000 [00:00<?, ?it/s]
0.0004
batch_time: 2.966813802719116
  0%|                                                                                                                                                                                                                                                             | 0/1 [00:00<?, ?it/s]
get_batch_contrastive_loss time: 2.5215377807617188
passed train_by_single_batch

An arbitrary loader is used instead of Validation loader

  0%|                                                                                                                                                                                                                                               | 2/9000 [00:17<19:54:00,  7.96s/it]
batch_time: 2.866222858428955
get_batch_contrastive_loss time: 1.0073158740997314
passed train_by_single_batch
0.0004

  0%|                                                                                                                                                                                                                                               | 3/9000 [00:21<15:36:00,  6.24s/it]
get_batch_contrastive_loss time: 1.0278031826019287
passed train_by_single_batch

  0%|                                                                                                                                                                                                                                               | 4/9000 [00:25<13:22:55,  5.36s/it]
batch_time: 2.8126485347747803
get_batch_contrastive_loss time: 0.9739587306976318
passed train_by_single_batch
0.0004
batch_time: 2.8456382751464844
get_batch_contrastive_loss time: 0.96240234375
passed train_by_single_batch

  0%|▏                                                                                                                                                                                                                                              | 5/9000 [00:29<12:11:17,  4.88s/it]

  0%|▏                                                                                                                                                                                                                                              | 6/9000 [00:33<11:34:07,  4.63s/it]
get_batch_contrastive_loss time: 1.0095915794372559
passed train_by_single_batch
0.0004
batch_time: 2.9186079502105713
get_batch_contrastive_loss time: 0.9984290599822998
passed train_by_single_batch

  0%|▏                                                                                                                                                                                                                                              | 7/9000 [00:38<11:14:19,  4.50s/it]

  0%|▏                                                                                                                                                                                                                                              | 8/9000 [00:42<10:54:38,  4.37s/it]
get_batch_contrastive_loss time: 0.9860162734985352
passed train_by_single_batch
0.0004

  0%|▏                                                                                                                                                                                                                                              | 9/9000 [00:46<10:59:07,  4.40s/it]
get_batch_contrastive_loss time: 0.9952571392059326
passed train_by_single_batch
0.0004

  0%|▎                                                                                                                                                                                                                                             | 10/9000 [00:50<10:52:56,  4.36s/it]
get_batch_contrastive_loss time: 1.0126159191131592
passed train_by_single_batch
0.0004
  0%|▎                                                                                                                                                                                                                                             | 10/9000 [00:55<13:44:45,  5.50s/it]
Traceback (most recent call last):
  File "emb_train.py", line 167, in <module>
    trainer.train_by_num_epoch(args.num_epochs)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 89, in train_by_num_epoch
    loss_value, loss_dict = self._train_by_single_batch(batch, reg_abc_loss=None, reg_ttl_loss=None)
  File "/home/clay/userdata/title_generation/emb_trainer.py", line 158, in _train_by_single_batch
    loss.backward()
  File "/home/clay/.local/lib/python3.8/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/clay/.local/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
get_batch_contrastive_loss time: 0.975513219833374